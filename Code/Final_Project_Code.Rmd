---
output: 
  pdf_document:
    keep_tex: yes
    fig_caption: yes
    number_sections: yes
geometry: margin=2.54cm
title: "Relationship Between Financial Data and Forest Coverage in 2018"
subtitle: "https://github.com/emmadeangeli/Shapiro_DeAngeli_Culberson_ENV872_EDA_FinalProject.git"
author: "Ben Culberson, Emma DeAngeli, and Shana Shapiro"
fontsize: 12pt
mainfont: Times New Roman

---

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set your working directory
getwd()

# Load your packages
library(tidyverse)
library(lubridate)
library(agricolae)
library(ggplot2)
library(zoo)
library(trend)
library(readxl)
library(dplyr)
library(ggrepel)

# Set your ggplot theme
mytheme <- theme_classic(base_size = 14) +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "right")

theme_set(mytheme)

```

```{r load.and.clean, include = FALSE}
GFD.df <- read.csv("../Data/Processed/GFD_processed.csv", stringsAsFactors = TRUE)
GEM.df <- read.csv("../Data/Processed/GEM_processed.csv", stringsAsFactors = TRUE)
CCDR.df <- read.csv("../Data/Processed/All_Countries_Forest_Share_2018_processed.csv", stringsAsFactors = TRUE)

finance_forests.df <- left_join(GFD.df, GEM.df)
finance_forests.df <- left_join(finance_forests.df, CCDR.df)
finance_forests.df <- select(finance_forests.df, Country:credit.to.private, Reserves, Forest_Share_of_Surface)
finance_forests.df <- na.omit(finance_forests.df)

#write.csv(GFD_clean, file = "../Data/Processed/finance_forests.csv", row.names=FALSE)
```

# Rationale and Research Questions

We were initially interested in whether climate financing correlated to environmental health in various countries. However, we could not find enough data to lead to a robust analysis. Instead, we are looking into whether different financial indicators (in as many countries as we could find) lead specifically to forest coverage. In our project, we are using forest coverage as a proxy for environmental health. Developed countries may have the luxury of being able to preserve their forests. We were particularly interested in seeing if other financial indicators related to forest coverage. Our main research question was "do financial indicators correlate to forest coverage for different countries in 2018?" Therefore, our hypotheses are the following:

$$H_0$$: There are no financial indicators or combination of financial indicators that correlate to forest coverage.
$$H_a$$: There is at least one financial indicator or combination of financial indicators that correlates to forest coverage.


\newpage

# Dataset Information

We pulled our data from three databases on the World Bank website: Global Financial Development, Global Economic Monitor, and Country Climate and Development Report. The first two have variables related to financial and economic data while the third has variables related to climate and development. After initial exploration into the most climate-vulnerable countries, we selected four variables to analyze:

---
 - Central bank assets to GDP (%)
 - Domestic credit to private sector (% of GDP)
 - Domestic Reserves (Million US$)
 - **Dependent variable:** Share of surface occupied by forest (%)
 
---


\newpage

# Exploratory Analysis 


## Individual Linear Regressions with Each Financial Variable

```{r mvr.ctp}
forest.regression1 <- lm(data = finance_forests.df, Forest_Share_of_Surface ~ credit.to.private)
summary(forest.regression1)

```

```{r mvr.atg}
forest.regression2 <- lm(data = finance_forests.df, Forest_Share_of_Surface ~ assets.to.gdp)
summary(forest.regression2)

```

```{r mvr.res}
forest.regression3 <- lm(data = finance_forests.df, Forest_Share_of_Surface ~ Reserves)
summary(forest.regression3)

```

## Plots of share of surface occupied by foreast on all 3 financial variables

```{r}
#Plot of Domestic Credit to Private Sector (% of GDP)
ggplot(finance_forests.df, aes(x = credit.to.private, y = Forest_Share_of_Surface)) + 
  geom_point() +
  geom_label_repel(aes(label = Country),
                  box.padding   = 5, 
                  point.padding = 0.5,
                  max.overlaps = 50,
                  segment.color = 'grey50')+
  geom_smooth(method = 'lm', se = FALSE, color = "darkgreen") +
  labs(x = "Ratio of Domestic Credit Provided by Private Sector to GDP (%)", y = "Forest Coverage (%)", title = "Forest Coverage and Private Credit")
```

```{r}
#Plot of Central Bank Assets to GDP
ggplot(finance_forests.df, aes(x = assets.to.gdp, y = Forest_Share_of_Surface, label=Country)) + 
  geom_point() +
  geom_label_repel(aes(label = Country),
                  box.padding   = 5, 
                  point.padding = 0.5,
                  max.overlaps = 10,
                  segment.color = 'grey50')+
  geom_smooth(method = 'lm', se = FALSE, color = "darkblue")
  labs(x = "Ratio of Central Bank Assets to GDP (%)", y = "Forest Coverage (%)", title = "Forest Coverage and Central Bank Assets")
```

```{r}
#Plot of Domestic Reserves (Million US$) 

ggplot(finance_forests.df, aes(x = Reserves , y = Forest_Share_of_Surface, label=Country)) + 
  geom_point() +
  geom_label_repel(aes(label = Country),
                  box.padding   = 3, 
                  point.padding = 0.5,
                  max.overlaps = 100,
                  segment.color = 'grey50')+
  geom_smooth(method = 'lm', se = FALSE, color = "red") +
  labs(x= 'Total Reserves (Million US$)', y = "Forest Coverage (%)", title = "Forest Coverage and Total Reserves")
```


## Residuals and Errors

```{r}
par(mfrow = c(2,2), mar=c(4,4,4,4))
plot(forest.regression1)
par(mfrow = c(1,1))
```

```{r}
par(mfrow = c(2,2), mar=c(4,4,4,4))
plot(forest.regression2)
par(mfrow = c(1,1))
```

```{r}
par(mfrow = c(2,2), mar=c(4,4,4,4))
plot(forest.regression3)
par(mfrow = c(1,1))
```

## Creating a Multivariate Linear Model

```{r forest.model}
Forestfinance.AIC <- lm(data = finance_forests.df, Forest_Share_of_Surface ~ credit.to.private + assets.to.gdp + Reserves)
 step(Forestfinance.AIC)
 summary(Forestfinance.AIC)
 
# the best result is to eliminate credit.to.private and Reserves, so "forest.regression2" from earlier is the best we'll get

Forestfinance.MR <- lm(data = finance_forests.df, Forest_Share_of_Surface ~ assets.to.gdp)
summary(Forestfinance.MR)

```

```{r}
Forestfinance.anova <- aov(data = finance_forests.df, Forest_Share_of_Surface ~ assets.to.gdp)
summary(Forestfinance.anova)
```

\newpage

# Analysis

For the individual regressions with each of the financial variables we selected, only the p-value for the assets.to.gdp variable was significant at 0.01295. The adjusted R-squared in this case was 0.052, meaning that the linear model explains 6% of the data. 

From the residual plots, we see that the third regression (for Reserves) had data concentrated highly in the left of most of the plots, making the fitted lines oddly-shaped. The first regression (for assets.to.gdp) seemed to indicate a more normal distribution of data without as many stark outliers. The second (for credit.to.private), suprisingly, seems to have a lot of concentration of data, much like in the third plot.

In the multivariate regression with all the variables, we get a slightly significant p-value less than 0.1, but from the AIC step model we see that the model is better without the Reserves and the assets.to.gdp variables.

## Question: Do financial indicators correlate to forest coverage for different countries in 2018?




\newpage

# Summary and Conclusions




